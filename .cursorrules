# ‚õî CURSOR AI RULES - STRICT ENFORCEMENT ‚õî
# LAST WORKING STATE: Dec 3, 2025 (Tag: WORKING_DEC3_2025)
# ============================================================

## üö® ABSOLUTE REQUIREMENT: ASK BEFORE MODIFYING

**BEFORE touching ANY code, you MUST:**
1. Tell the user which file you want to modify
2. Explain what change you want to make
3. WAIT for user to say "yes" or "approved" or "go ahead"
4. Only THEN make the change

**Example:**
```
AI: "I need to modify templates/manual_copy_trader.html to fix the button. Can I proceed?"
User: "Yes"
AI: [Now makes the change]
```

**If user doesn't explicitly approve, DO NOT MODIFY THE FILE.**

---

## üîí LOCKED FILES - NEVER MODIFY WITHOUT EXPLICIT APPROVAL

These files are WORKING. Do not touch them without user saying "yes, modify X file":

```
‚õî LOCKED - ASK FIRST:
‚îú‚îÄ‚îÄ ultra_simple_server.py
‚îú‚îÄ‚îÄ templates/manual_copy_trader.html
‚îú‚îÄ‚îÄ templates/account_management.html  ‚Üê NEVER TOUCH
‚îú‚îÄ‚îÄ templates/recorders.html
‚îú‚îÄ‚îÄ templates/recorders_list.html
‚îú‚îÄ‚îÄ templates/dashboard.html
‚îú‚îÄ‚îÄ templates/control_center.html
‚îî‚îÄ‚îÄ just_trades.db
```

---

## üö´ THINGS YOU MUST NEVER DO

1. **NEVER refactor or "improve" working code**
2. **NEVER remove code you think is "unused"**
3. **NEVER change code formatting or indentation**
4. **NEVER modify files from other tabs**
5. **NEVER modify database schemas**
6. **NEVER overwrite backup files**
7. **NEVER make bulk edits**
8. **NEVER add features not explicitly requested**

---

## ‚úÖ WORKING FEATURES (DO NOT BREAK)

| Feature | Status | Last Verified |
|---------|--------|---------------|
| Manual Trader Tab | ‚úÖ WORKING | Dec 3, 2025 |
| Live Position Cards | ‚úÖ WORKING | Dec 3, 2025 |
| Account PnL Display | ‚úÖ WORKING | Dec 3, 2025 |
| Recorders Tab | ‚úÖ WORKING | Dec 3, 2025 |
| Webhook Signals | ‚úÖ WORKING | Dec 3, 2025 |
| Trade Recording | ‚úÖ WORKING | Dec 3, 2025 |
| Dashboard | ‚úÖ WORKING | Dec 3, 2025 |
| Control Center | ‚úÖ WORKING | Dec 3, 2025 |
| Account Management | ‚úÖ WORKING | Dec 3, 2025 |
| Tradovate OAuth | ‚úÖ WORKING | Dec 3, 2025 |
| WebSocket Updates | ‚úÖ WORKING | Dec 3, 2025 |
| Copy Trading | ‚úÖ WORKING | Dec 3, 2025 |

---

## üìã TAB ISOLATION - MANDATORY

**When user says "work on X tab", ONLY touch files for that tab:**

| Tab | ONLY These Files |
|-----|------------------|
| Manual Trader | `manual_copy_trader.html`, manual trade routes |
| Recorders | `recorders.html`, `recorders_list.html`, recorder routes |
| Dashboard | `dashboard.html`, dashboard routes |
| Control Center | `control_center.html`, control center routes |
| Account Management | **NEVER TOUCH** |

**üö® If you touch a file NOT in the tab's list, YOU ARE BREAKING THE RULES.**

---

## üîß SAFE CHANGE PROCESS

### Step 1: ASK PERMISSION
```
"I want to modify [filename] to [do what]. Is this okay?"
```

### Step 2: WAIT FOR APPROVAL
Do not proceed until user explicitly approves.

### Step 3: ONE SMALL CHANGE
- Edit ONLY the specific lines needed
- Do NOT touch surrounding code
- Do NOT "clean up" other parts

### Step 4: VERIFY
- Test the change works
- Check no regressions

### Step 5: IF BROKEN, RESTORE
```bash
cp backups/WORKING_STATE_DEC3_2025/[filename] ./
# OR
git checkout WORKING_DEC3_2025 -- [filename]
```

---

## üÜò RECOVERY COMMANDS

```bash
# Restore single file from backup
cp backups/WORKING_STATE_DEC3_2025/ultra_simple_server.py ./
cp backups/WORKING_STATE_DEC3_2025/manual_copy_trader.html templates/

# Restore ALL templates
cp backups/WORKING_STATE_DEC3_2025/*.html templates/

# Full git restore to working state
git checkout WORKING_DEC3_2025

# Restart server
pkill -f "python.*ultra_simple"
nohup python3 ultra_simple_server.py > /tmp/server.log 2>&1 &
```

---

## üìö PAST MISTAKES - LEARN FROM THESE

### ‚ùå Mistake: Bulk refactoring
**What happened:** AI "improved" code style, broke everything
**Lesson:** NEVER refactor working code

### ‚ùå Mistake: Modifying multiple tabs
**What happened:** Fixed one tab, broke three others
**Lesson:** ONE TAB AT A TIME

### ‚ùå Mistake: Changing database schema
**What happened:** Added columns, broke existing queries
**Lesson:** NEVER change DB schema without approval

### ‚ùå Mistake: Removing "unused" code
**What happened:** Removed code that was actually used elsewhere
**Lesson:** NEVER remove code you didn't write

### ‚ùå Mistake: Making unauthorized changes
**What happened:** AI made changes without asking, broke working features
**Lesson:** ALWAYS ASK FIRST

---

## ‚ö†Ô∏è FINAL WARNING

This codebase has been BROKEN MULTIPLE TIMES by AI making unauthorized changes.

**EVERY SINGLE CHANGE requires:**
1. ‚úÖ User permission (explicit "yes")
2. ‚úÖ Clear explanation BEFORE changing
3. ‚úÖ Single file, minimal edit
4. ‚úÖ Immediate testing
5. ‚úÖ Rollback plan ready

**When in doubt: ASK THE USER.**

**If user hasn't said "yes", DON'T TOUCH IT.**

---

*Backup: backups/WORKING_STATE_DEC3_2025/*
*Git tag: WORKING_DEC3_2025*
*Last verified: Dec 3, 2025*
